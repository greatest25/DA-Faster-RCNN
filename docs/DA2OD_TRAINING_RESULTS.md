# DA2OD å®Œæ•´è®­ç»ƒç»“æœæŠ¥å‘Š

## è®­ç»ƒé…ç½®
- **æ¡†æ¶**: DA2OD (Differential Alignment for Domain Adaptive Object Detection)
- **Backbone**: ResNet50 + FPN
- **åŸŸé€‚åº”**: Image-level alignment (p2 layer) + Mean Teacher (EMA Î±=0.999)
- **æ•°æ®é›†**: Cityscapes Clearâ†’Foggy
  - Source (labeled): 2,965å¼ , 52,469ä¸ªæ ‡æ³¨
  - Target (pseudo-labels): 3,435å¼ , 29,907ä¸ªæ ‡æ³¨ (threshold=0.7)
- **è¿­ä»£æ¬¡æ•°**: 5,000
- **å­¦ä¹ ç‡**: 0.001 (warmup 500â†’3000), 0.0001 (3000â†’4500), 0.00001 (4500â†’5000)
- **è®­ç»ƒæ—¶é—´**: ~56åˆ†é’Ÿ (15:55:53 â†’ 16:52:50)

## æŸå¤±å‡½æ•°æ”¶æ•›æ›²çº¿

| Iteration | total_loss | loss_cls | loss_box_reg | loss_rpn_cls | loss_rpn_loc | loss_da_img_src | loss_da_img_tgt |
|-----------|------------|----------|--------------|--------------|--------------|-----------------|-----------------|
| 19        | 3.691      | 2.345    | 0.8149       | 0.09039      | 0.2026       | 0.06675         | 0.07099         |
| 59        | 2.268      | 0.907    | 0.7825       | 0.1087       | 0.2676       | 0.06832         | 0.06946         |
| 999       | 1.210      | 0.288    | 0.4668       | 0.05092      | 0.1678       | 0.06944         | 0.05807         |
| 1999      | 0.993      | 0.254    | 0.3906       | 0.04151      | 0.1007       | 0.04635         | 0.03746         |
| 2999      | 0.896      | 0.243    | 0.4468       | 0.03076      | 0.08093      | 0.02638         | 0.02183         |
| 3999      | 0.876      | 0.281    | 0.4209       | 0.03084      | 0.08841      | 0.02512         | 0.01961         |
| 4999      | 0.858      | 0.260    | 0.3909       | 0.03352      | 0.1047       | 0.02428         | 0.01848         |

**å…³é”®è§‚å¯Ÿ**:
- æ€»æŸå¤±: 3.691 â†’ 0.858 (é™ä½77%)
- åˆ†ç±»æŸå¤±: 2.345 â†’ 0.260 (é™ä½89%)
- åŸŸå¯¹é½æŸå¤±ç¨³å®šæ”¶æ•›: 0.067â†’0.024 (source), 0.071â†’0.018 (target)

## æ¨¡å‹æ€§èƒ½è¯„ä¼° (city_testT - Foggy)

### å„checkpoint AP@[0.50:0.95]
| Iteration | AP    | AP50  | AP75  | Best Model |
|-----------|-------|-------|-------|------------|
| 1000      | 22.8% | 40.4% | 22.5% |            |
| 2000      | 25.5% | 44.6% | 25.3% |            |
| 3000      | 27.8% | 46.9% | 27.7% |            |
| 4000      | (æœªæ˜¾ç¤ºå®Œæ•´, è¢«5000è¦†ç›–)  |            |
| 5000      | 28.2% | 48.1% | 29.3% | âœ“ **BEST** |

### æœ€ç»ˆæ€§èƒ½ (iter=5000, EMAæ¨¡å‹)
```
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.282
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.481
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.293
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.035
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.200
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.454
```

### å„ç±»åˆ«æ€§èƒ½ (AP50)
| Category   | AP50   | Confidence |
|------------|--------|------------|
| car        | 74.98% | ğŸ”¥ ä¼˜ç§€    |
| person     | 58.30% | âœ… è‰¯å¥½    |
| rider      | 55.81% | âœ… è‰¯å¥½    |
| bicycle    | 49.09% | âš ï¸ ä¸­ç­‰    |
| bus        | 44.77% | âš ï¸ ä¸­ç­‰    |
| motorcycle | 40.86% | âš ï¸ ä¸­ç­‰    |
| truck      | 34.36% | âš ï¸ ä¸­ç­‰    |
| train      | 26.89% | âŒ è¾ƒå¼±    |

## æ€§èƒ½å¯¹æ¯”

### Baseline vs DA2OD
| æ¨¡å‹              | AP@50:95 | AP50  | æå‡    |
|-------------------|----------|-------|---------|
| R50-FPN (Source-only) | 32.1%    | 55.0% | -       |
| DA2OD (Pseudo+DA) | **28.2%** | **48.1%** | **-3.9%/-6.9%** |

**âš ï¸ é‡è¦å‘ç°**: DA2ODæ€§èƒ½**ä½äºbaseline**!

### å¯èƒ½åŸå› åˆ†æ
1. **ä¼ªæ ‡ç­¾è´¨é‡**: é˜ˆå€¼0.7å¯èƒ½å¼•å…¥å™ªå£° (29,907ä¸ªæ ‡æ³¨ vs sourceçš„52,469ä¸ª)
2. **åŸŸå¯¹é½è¿‡æ‹Ÿåˆ**: loss_da_imgæ”¶æ•›è¿‡å¿«,å¯èƒ½å¯¼è‡´ç‰¹å¾å¯¹é½ä¸å……åˆ†
3. **å­¦ä¹ ç‡ç­–ç•¥**: å¯èƒ½éœ€è¦æ›´é•¿warmupæˆ–ä¸åŒçš„è¡°å‡ç­–ç•¥
4. **EMA vs Student**: å½“å‰è¯„ä¼°çš„æ˜¯EMAæ¨¡å‹,Studentæ¨¡å‹å¯èƒ½è¡¨ç°ä¸åŒ
5. **ä¼ªæ ‡ç­¾æœªæ›´æ–°**: è®­ç»ƒè¿‡ç¨‹ä¸­ä¼ªæ ‡ç­¾å›ºå®š,æœªè¿­ä»£refinement

## ä¿å­˜çš„æ¨¡å‹æ–‡ä»¶
```
output_da2od_full/
â”œâ”€â”€ city_testT_model_best.pth    (480MB) - Best model @ iter 4999, AP50=48.1%
â”œâ”€â”€ model_0000999.pth            (480MB) - Checkpoint @ iter 1000
â”œâ”€â”€ model_0001999.pth            (480MB) - Checkpoint @ iter 2000
â”œâ”€â”€ model_0002999.pth            (480MB) - Checkpoint @ iter 3000
â”œâ”€â”€ model_0003999.pth            (480MB) - Checkpoint @ iter 4000
â”œâ”€â”€ model_0004999.pth            (480MB) - Checkpoint @ iter 5000
â””â”€â”€ model_final.pth              (480MB) - Final EMA model
```

## ä¸‹ä¸€æ­¥å»ºè®®

### 1. è¯Šæ–­æ€§åˆ†æ
- [ ] è¯„ä¼°Studentæ¨¡å‹ (éEMA) æ€§èƒ½
- [ ] å¯è§†åŒ–è®­ç»ƒé›†é¢„æµ‹è´¨é‡ (source vs target)
- [ ] åˆ†æä¼ªæ ‡ç­¾å¬å›ç‡å’Œå‡†ç¡®ç‡
- [ ] æ£€æŸ¥åŸŸå¯¹é½ç‰¹å¾çš„t-SNEå¯è§†åŒ–

### 2. æ”¹è¿›ç­–ç•¥
- [ ] **ä¼ªæ ‡ç­¾ä¼˜åŒ–**: æé«˜é˜ˆå€¼åˆ°0.8-0.9,æˆ–ä½¿ç”¨åŠ¨æ€é˜ˆå€¼
- [ ] **è¿­ä»£è®­ç»ƒ**: å®ç°ä¼ªæ ‡ç­¾refinement (re-generate afteræ¯1000 iters)
- [ ] **åŸŸå¯¹é½å¢å¼º**: æ·»åŠ instance-level alignmentæˆ–feature-level alignment
- [ ] **è¶…å‚æ•°è°ƒä¼˜**: 
  - EMA decay: 0.999 â†’ 0.9999 (æ›´ä¿å®ˆ)
  - åŸŸå¯¹é½æƒé‡: è°ƒæ•´loss_da_imgçš„ç³»æ•°
  - å­¦ä¹ ç‡: å»¶é•¿warmupåˆ°1000 iters
- [ ] **æ•°æ®å¢å¼º**: Strong augmentation for unlabeled data

### 3. BaselineéªŒè¯
- [ ] é‡æ–°è¯„ä¼°baseline (ç¡®è®¤32.1%æ˜¯å¦æ­£ç¡®)
- [ ] ä½¿ç”¨ç›¸åŒè¯„ä¼°åè®® (åŒä¸€ä¸ªcity_testT split)
- [ ] å¯¹æ¯”pseudo-label baseline (æ— åŸŸå¯¹é½,ä»…ç”¨ä¼ªæ ‡ç­¾)

## ç»“è®º

âœ… **è®­ç»ƒæˆåŠŸå®Œæˆ**: 5000æ¬¡è¿­ä»£,æŸå¤±æ­£å¸¸æ”¶æ•›,æ— é”™è¯¯
âš ï¸ **æ€§èƒ½æœªè¾¾é¢„æœŸ**: DA2OD (28.2%) < Baseline (32.1%), é™ä½3.9%
ğŸ” **éœ€è¦æ·±å…¥åˆ†æ**: å¯èƒ½æ˜¯ä¼ªæ ‡ç­¾è´¨é‡ã€åŸŸå¯¹é½ç­–ç•¥æˆ–è¶…å‚æ•°é—®é¢˜

å»ºè®®ä¼˜å…ˆè¿›è¡Œè¯Šæ–­æ€§åˆ†æ,ç¡®å®šæ€§èƒ½ä¸‹é™çš„æ ¹æœ¬åŸå› åå†ä¼˜åŒ–ã€‚
